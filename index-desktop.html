  <!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>CÔNG CỤ DỰ TÍNH THU NHẬP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="font/fonts.css">
  <!-- Thêm thư viện html2pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    html, body {height: 100%; margin: 0; padding: 0;}
    body {
         background: url('BGINCOME.webp') center/cover no-repeat fixed;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
    }
    .container {
      max-width: 480px;
      background: #ffffffee;
      margin: 0px auto 0px auto;
      border-radius: 16px;
      box-shadow: 0 2px 16px #bbb8;
      padding: 18px 15px 24px 15px;
      box-sizing: border-box;
      position: relative;
      z-index: 1;
    }
     .top-fields, .top-fields-2 {
      display: flex;
      gap: 18px;
      margin-bottom: 10px;
      flex-wrap: wrap;
      align-items: flex-end;
    }
    .top-fields-2 {
      margin-bottom: 8px;
    }
    .top-fields > .field, .top-fields-2 > .field {
      min-width: 100px;
      flex:1 ;
          }
    .field {
      display: flex;
      flex-direction: column;
      margin-bottom: 0;
      white-space: nowrap;
    }
    .field label {
      font-size: 1em;
      font-weight: 500;
      color: #222;
      letter-spacing: 0.01em;
      text-align: left;
      white-space: nowrap;
      
    }
    .field input, .field select {
      height: 40px;
      padding: 0 12px;
      font-size: 1.08em;
      border: 1.3px solid #c7d5e6;
      border-radius: 7px;
      background-color:rgba(214,255,237,0.3);
      font-family: inherit;
      font-weight: 600;
      color: #0051c1;
      outline: none;
      transition: border-color .18s;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
    }
    .field input[readonly] {
      background: #fafbfd;
      color: #00a758;
      font-weight: 600;
      border: 1.1px solid #bbb;
    }
    h1 {
      font-family:'Manulife JH Sans';
      font-size:1.5em;
      text-align: center;
      color: #0000C1;
      margin-bottom:0em;
      letter-spacing: 0.05em;
      font-weight: 700;
    }
    h2 {
      font-family: 'Manulife JH Sans';
      font-size: 1.3em !important;
      text-align: center;
      color: #00519c;
      font-weight: 600;
    }
    h3 {
      font-family:'Manulife JH Serif',Serif;
      text-align: center;
      color: #00a758;
      letter-spacing: 0.05em;
      font-weight: 400;
      font-style: italic;
    }
     h2 {
      font-family: 'Manulife JH Sans';
      font-size: 1.3em !important;
      text-align: center;
      color: #00519c;
      font-weight: 600;
     
       margin-bottom:0;
    }
    h4 {
      font-family: 'Manulife JH Sans';
      font-size: 0.9em !important;
      text-align: left;
      color: #00519c;
      font-weight: bold;
      margin-bottom:0;
      margin-top:0.5;
      
    }
     .summary-row {
      display: flex;
      gap: 28px;
      margin-top: 18px;
      margin-bottom: 14px;
      justify-content: center;
      align-items: flex-end;
      white-space: nowrap;
    }
    .summary-block {
      flex: 1 1 0;
      text-align: center;
      white-space: nowrap;
    }
    .summary-block label {
      color: #0051c1;
      font-weight: 700;
      font-size: 1.13em;
      letter-spacing: 0.02em;
      margin-bottom: 3px;
      display: block;
      text-transform: uppercase;
      white-space: nowrap;
    }
    .summary-block input {
      background: #fff;
      color: #048f60;
      border: 2px solid #00a578;
      border-radius: 8px;
      font-size: 2.1em;
      font-weight: 900;
      height: 52px;
      text-align: center;
      width: 95%;
      max-width: 320px;
      margin: 0 auto;
      box-sizing: border-box;
      white-space: nowrap;
    }
    label {
      display: flex;
      align-items: center;
      margin: 7px 7px;
      font-size: 0.8em ! important;
      font-weight: 400;
    }
    label input[type="text"], label input[type="number"], label select {
      flex: 1;
      margin-top: 1px;
      margin: 7px 7px;
      padding: 6px 10px;
      border: 1px solid #a7b7cc;
      border-radius: 8px;
      font-size: 1.2em ! important;
      min-width: 0;;
      background: #f5f7fb;
    }
    label1 {
      display: flex;
      margin-top: 1px;
      align-items: center;
      margin: 7px 7px;
      font-size: 0.8em;
      font-weight: 400;
    }
    label1 input[type="text"], label1 input[type="number"], label1 select {
      flex: 1;
      padding: 6px 10px;
      align-items: center;
      border: 1px solid #a7b7cc;
      border-radius: 8px;
      font-size: 1.2em !important ;
      min-width: 0;
      margin: 7px 7px;
      background-color: rgba( 0,255,1,0.3);
    }
    .note-green {
      color: #00a758;
      font-style: italic;
      font-size: 1em ! important;
      margin-top: 0;
      font-weight:bold;
      margin-bottom: 0.1em;
      text-align: center;
      white-space: nowrap;
    }
    .note-right {
      text-align: right;
      font-size: 0.8em ! important;
      font-style: italic;
      margin-bottom: 6px;
      color: #333;
      font-weight: bold;
      white-space: nowrap;
    }
    hr {
      border: none;
      border-top: 1.7px solid #e3e7eb;
    }
    .income-mini-title { font-size: 1em; color: #0051c1; font-weight: 600; margin-bottom: 4px; text-align: left; margin-left: 2px; white-space: nowrap;}
    .income-note {
      font-size: 1em;
      color: #0051c1;
      margin-bottom: 2px;
      text-align: left;
      margin-left: 4px;
      font-weight: 600;
      white-space: nowrap;
    }
    .note-green {
      color: #00a758;
      font-style: italic;
      font-size: 15pt;
      margin-top: 0;
      margin-bottom: 0.1em;
      text-align: center;
      white-space: nowrap;
    }
    .note-right {
      text-align: right;
      font-size: 15pt;
      font-style: italic;
      margin-bottom: 6px;
      color: #333b;
      white-space: nowrap;
    }
    button {
      margin: 1px 7px;
      padding: 6px 10px;
      align-items: center;
      display: block;
      background: #0d72b5;
      color: #fff;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      padding: 10px 26px;
      font-size: 1.07em;
      transition: background 0.16s;
      cursor: pointer;
      box-shadow: 0 2px 8px #0d72b533;
    }
    button:hover {
      background: #085a93;
    }
    .memo-group label {
      display: flex;
      align-items: center;
      margin-bottom: 3px;
      font-size: 0.97em;
    }
    .memo-group input[type="radio"] {
      margin-right: 8px;
    }
    .highlight-label {
      color: #00a758 !important;
      font-weight: bold !important;
      font-Size: 3em !important;
    }
    .unit {
      font-weight: normal !important;
      color: #333 !important;
      font-size: 0.95em;
      opacity: 0.8;
      font-style: italic;
    }
    .unit2 {
      font-size: 0.8em;
      font-style: italic;
      margin-left: 10px;
    }
    .unit3 {
      font-size: 0.8em;
      font-style: italic;
      margin-left: 5px;
      text-align: bottom;
    }
    @media (max-width: 500px) {
      .container {
        padding: 6px 10px 16px 10px;
        border-radius: 0;
        max-width: 100vw;
        margin: 0;
        box-shadow: none;
      }
      label, h2, h3, h4 {
        font-size: 1em;
      }
      button {
        font-size: 1em;
      }
     
    }
  </style>
  <script>
    let data = [], nspro = [], nst6 = [], nst7 = [], nsq6 = [], nsq7 = [], hsdt = [], trackingMDRT = [];

    async function loadData() {
      data = await (await fetch('data.json')).json();
      nspro = await (await fetch('nspro.json')).json();
      nst6 = await (await fetch('6nst.json')).json();
      nst7 = await (await fetch('7nst.json')).json();
      nsq6 = await (await fetch('6NSQ.json')).json();
      nsq7 = await (await fetch('7NSQ.json')).json();
      hsdt = await (await fetch('hsdt.json')).json();
      try {
        trackingMDRT = await (await fetch('TRACKING MDRT.json')).json();
      } catch (e) {
        trackingMDRT = [];
      }
    }

    function getCurrentMonth() {
      return new Date().getMonth() + 1;
    }

    function populateMonthSelect() {
      const currentMonth = getCurrentMonth();
      const select = document.getElementById("month-select");
      select.innerHTML = '';
      for (let m = currentMonth; m <= 12; m++) {
        const option = document.createElement("option");
        option.value = m;
        option.text = `Tháng ${m}`;
        select.appendChild(option);
      }
    }

    function formatNumber(val) {
      if (val === "" || val === null || val === undefined || isNaN(val)) return "";
      return Number(val).toLocaleString('vi-VN', {minimumFractionDigits: 3, maximumFractionDigits: 3});
    }
    function parseVnNumber(str) {
      if (typeof str === "number") return str;
      if (!str) return 0;
      str = str.toString().replace(/\./g, '').replace(',', '.');
      return parseFloat(str);
    }
    function getHeSoThuong(p13) {
      if (p13 === null || p13 === undefined || p13 === '' || isNaN(p13)) return 1;
      let heSo = p13 / 100;
      for (let i = hsdt.length - 1; i >= 0; i--) {
        const moc = hsdt[i]["P13 cá nhân"];
        const tile = hsdt[i]["TỶ LỆ"];
        if (moc !== null && p13 >= moc) {
          heSo = tile;
          break;
        }
      }
      return heSo;
    }
    function searchAgent() {
      const inputID = document.getElementById("agent-id").value.trim().toLowerCase();
      const inputDate = document.getElementById("ngay-gia-nhap").value.trim();
      if (!inputID || !inputDate) {
        alert("Vui lòng nhập cả Mã số đại lý và Ngày gia nhập");
        return;
      }
      const agent = data.find(row =>
        (row["Mã Đại lý"]?.toString().toLowerCase() === inputID) &&
        (row["Ngày gia nhập"]?.toString().trim() === inputDate)
      );
      if (agent) {
        document.getElementById("ho-ten").value = agent["Tên Đại lý"] || "";
        document.getElementById("khu-vuc").value = agent["Khu vực"] || "";
        document.getElementById("nhom-dai-ly").value = agent["Nhóm Đại lý"] || "";
        document.getElementById("thang-lam-viec").value = agent["Số tháng làm việc"] +" tháng"|| "";
        document.getElementById("ngay-gia-nhap").value = agent["Ngày gia nhập"] || "";
        let p13 = agent["TLDTHD cá nhân"];
        p13 = (p13 === '' || p13 === undefined || p13 === null) ? null : parseFloat(p13);
        document.getElementById("p13-ca-nhan").value = p13 != null ? p13 + "%" : '';
        const heSo = getHeSoThuong(p13);
        document.getElementById("he-so-thuong").value = heSo;
        const fycT1 = parseFloat(agent["FYC tháng T-1"]) || 0;
        const fycT2 = parseFloat(agent["FYC tháng T-2"]) || 0;
        document.getElementById("tong-fyc").value = formatNumber(fycT1 + fycT2);
        let mdrtFyp = agent["MDRT-FYP tới hiện tại"];
        let fypThangT = agent["FYP tháng T"];
        mdrtFyp = (mdrtFyp === '' || mdrtFyp === undefined || mdrtFyp === null) ? 0 : parseFloat(mdrtFyp);
        fypThangT = (fypThangT === '' || fypThangT === undefined || fypThangT === null) ? 0 : parseFloat(fypThangT);
        let mdrtFypDenT1 = mdrtFyp - fypThangT;
        document.getElementById("mdrt-fyp").value = formatNumber(mdrtFypDenT1);
        const tongFYCQuyHienTai = parseFloat(agent["Tổng FYC trong Quý hiện tại"] ?? agent["Tổng FYC trong Qúy hiện tại"]) || 0;
        const fycThangT = parseFloat(agent["FYC tháng T"]) || 0;
        const tongFYCQuyHieu = tongFYCQuyHienTai - fycThangT;
        document.getElementById("tong-fyc-quy").value = formatNumber(tongFYCQuyHieu);
      } else {
        alert("Không tìm thấy đại lý với thông tin đã nhập hoặc thông tin không khớp!");
        ["ho-ten","khu-vuc","nhom-dai-ly","thang-lam-viec","p13-ca-nhan","he-so-thuong",
         "mdrt-fyp","tong-fyc","tong-fyc-quy"].forEach(id => document.getElementById(id).value = "");
      }
    }
    function initEnterSearch() {
      document.getElementById("agent-id").addEventListener("keydown", function(e) {
        if (e.key === "Enter") searchAgent();
      });
      document.getElementById("ngay-gia-nhap").addEventListener("keydown", function(e) {
        if (e.key === "Enter") searchAgent();
      });
    }

    // ----------- Cập nhật: Enter cho SỐ CC -----------
    function initEnterCC() {
      document.getElementById("tong-cc").addEventListener("keydown", function(e) {
        if (e.key === "Enter") {
          document.getElementById("calc-btn").click();
        }
      });
    }

    function calculateIncome() {
      const soCC = document.getElementById("tong-cc").value;
      if (!soCC || parseInt(soCC) < 1) {
        alert("Chưa nhập số lượng hợp đồng!\nBạn cần có ít nhất 1 hợp đồng 16tr FYP thực cấp trong tháng để nhận đầy đủ tiền thưởng. Vui lòng nhập lại");
        document.getElementById("tong-cc").focus();
        return;
      }
      const fypChinh = parseFloat(document.getElementById("fyp-chinh").value) || 0;
      const fypKem = parseFloat(document.getElementById("fyp-kem").value) || 0;
      const tongFYP = fypChinh + fypKem;
      document.getElementById("tong-fyp").value = formatNumber(tongFYP);
      const fycChinh = fypChinh * 0.3;
      const fycKem = fypKem * 0.2;
      const thuongKem = fypKem * 0.2;
      const fycThuong = fycChinh + fycKem;
      document.getElementById("fyc-chinh").value = formatNumber(fycChinh);
      document.getElementById("fyc-kem").value = formatNumber(fycKem);
      document.getElementById("thuong-kem").value = formatNumber(thuongKem);
      document.getElementById("fyc-thuong").value = formatNumber(fycThuong);

      calculateNSPro();
      calculateNST();
      calculateNSQ();
      calculateMemoBonus();
      calculateThuongMDRT();
      calculateTongThuNhap();
    }
    function calculateNSPro() {
      const cc = parseFloat(document.getElementById("tong-cc").value) || 0;
      const tongFYP = parseVnNumber(document.getElementById("tong-fyp").value);
      const rank = document.getElementById("nhom-dai-ly").value?.trim();
      let result = 0;
      if (cc >= 1 && rank) {
        for (let i = 0; i < nspro.length; i++) {
          const row = nspro[i];
          if (tongFYP >= row["FYP của tháng xét thưởng"]) {
            result = row[rank] || 0;
          }
        }
      }
      const heSo = parseFloat(document.getElementById("he-so-thuong").value) || 1;
      document.getElementById("thuong-nspro").value = formatNumber(result * heSo);
    }
    function calculateNST() {
      const thangLamViec = parseInt(document.getElementById("thang-lam-viec").value) || 0;
      const tongFYC = parseVnNumber(document.getElementById("tong-fyc").value);
      const fycThuong = parseVnNumber(document.getElementById("fyc-thuong").value);
      const tongFYCQuy = tongFYC + fycThuong;
      const bangNST = thangLamViec <= 6 ? nst6 : nst7;
      let tyLeThuong = 0;
      for (const row of bangNST) {
        if (tongFYCQuy >= parseFloat(row["FYC trong 3 tháng gần nhất"])) {
          tyLeThuong = row["% Tỷ lệ thưởng năng suất tháng"];
          break;
        }
      }
      const heSo = parseFloat(document.getElementById("he-so-thuong").value) || 1;
      document.getElementById("thuong-nst").value = formatNumber(fycThuong * tyLeThuong * heSo);
    }
    function calculateNSQ() {
      const selectedMonth = parseInt(document.getElementById("month-select").value) || 0;
      if (![3, 6, 9, 12].includes(selectedMonth)) {
        document.getElementById("thuong-nsq").value = formatNumber(0);
        return;
      }
      const thangLamViec = parseInt(document.getElementById("thang-lam-viec").value) || 0;
      const tongFYCQuyHienTai = parseVnNumber(document.getElementById("tong-fyc-quy").value);
      const fycThuong = parseVnNumber(document.getElementById("fyc-thuong").value);
      const tongFYCQuy = fycThuong + tongFYCQuyHienTai;
      const nsqTable = thangLamViec <= 6 ? nsq6 : nsq7;
      const nhom = (document.getElementById("nhom-dai-ly").value || "").trim();
      function getNSQCol(row, nhom) {
        const keys = Object.keys(row).reduce((a,k)=>{a[k.trim().toLowerCase()]=k;return a;},{});
        if (nhom.toLowerCase() === "manulife pro vàng" || nhom.toLowerCase() === "manulife pro bạch kim") {
          return row[keys["manulife"]] || row[keys["manulife pro"]] || row[keys["manulife pro vàng"]] || row[keys["manulife pro bạch kim"]];
        }
        return row[keys["dl thường"]] || row[keys["đại lý"]] || row[keys["dl thuong"]];
      }
      let tyLe = 0;
      for (let i = 0; i < nsqTable.length; i++) {
        const row = nsqTable[i];
        if (tongFYCQuy >= parseFloat(row["FYC của quý xét thưởng"])) {
          let val = getNSQCol(row, nhom);
          val = typeof val === "string" ? val.replace("%", "") : val;
          tyLe = parseFloat(val) / 100 || 0;
          break;
        }
      }
      const heSo = parseFloat(document.getElementById("he-so-thuong").value) || 1;
      const thuongNSQ = tongFYCQuy * tyLe * heSo;
      document.getElementById("thuong-nsq").value = formatNumber(thuongNSQ);
    }
    function calculateMemoBonus() {
      const cc = parseInt(document.getElementById("tong-cc").value) || 0;
      const fyp = parseVnNumber(document.getElementById("tong-fyp").value);
      const selected = document.querySelector('input[name="memo-period"]:checked');
      if (!selected) {
        document.getElementById("thuong-memo").value = formatNumber(0);
        calculateTongThuNhap();
        return;
      }
      const period = parseInt(selected.value);
      let muc1 = 0, muc2 = 0;
      if (period === 1) [muc1, muc2] = [2500, 1500];
      if (period === 2) [muc1, muc2] = [2000, 1000];
      if (period === 3) [muc1, muc2] = [1500, 750];

      let ccMuc1 = 0, ccMuc2 = 0;
      let remainFYP = fyp;
      for (let i = 0; i < cc; i++) {
        const chia = remainFYP / (cc - i);
        if (chia >= 25000) {
          ccMuc1 += 1;
          remainFYP -= 25000;
        } else if (chia >= 16000) {
          ccMuc2 += 1;
          remainFYP -= 16000;
        } else {
          break;
        }
      }
      const totalBonus = ccMuc1 * muc1 + ccMuc2 * muc2;
      document.getElementById("thuong-memo").value = formatNumber(totalBonus);
      calculateTongThuNhap();
    }
    function calculateThuongMDRT() {
      const thangDuTinh = parseInt(document.getElementById("month-select").value);
      const mdrtFypStr = document.getElementById("mdrt-fyp").value;
      const mdrtFyp = parseVnNumber(mdrtFypStr);
      const agent = data.find(row => row["Mã Đại lý"].toLowerCase() === document.getElementById("agent-id").value.trim().toLowerCase());
      if (!agent) {
        document.getElementById("thuong-mdrt").value = formatNumber(0);
        return;
      }
      const mdrtRow = trackingMDRT.find(row => parseInt(row["Tháng xét"]) === thangDuTinh);
      if (!mdrtRow) {
        document.getElementById("thuong-mdrt").value = formatNumber(0);
        return;
      }
      const fypYeuCau = parseFloat(mdrtRow["FYP YÊU CẦU"]) || 0;
      const muc1 = parseFloat(mdrtRow["MỨC 1 THẤP"]) || 0;
      const muc2 = parseFloat(mdrtRow["MỨC 2 CAO"]) || 0;
      const heSo = parseFloat(document.getElementById("he-so-thuong").value) || 1;
      const kq = fypYeuCau > 0 ? mdrtFyp / fypYeuCau : 0;
      let thuong = 0;
      if (kq >= 0.9 && kq < 1) thuong = muc1;
      if (kq >= 1) thuong = muc2;
      thuong = thuong * heSo;
      document.getElementById("thuong-mdrt").value = formatNumber(thuong);
    }

    // ---------- TÍNH TỶ LỆ THU NHẬP / FYP và HIỂN THỊ ----------
    function calculateTongThuNhap() {
      const getVal = id => parseVnNumber(document.getElementById(id).value);
      const fycChinh = getVal("fyc-chinh");
      const fycKem = getVal("fyc-kem");
      const thuongKem = getVal("thuong-kem");
      const thuongNSPro = getVal("thuong-nspro");
      const thuongNST = getVal("thuong-nst");
      const thuongNSQ = getVal("thuong-nsq");
      const thuongMemo = getVal("thuong-memo");
      const thuongMDRT = getVal("thuong-mdrt");
      const tongThuNhap = fycChinh + fycKem + thuongKem + thuongNSPro + thuongNST + thuongNSQ + thuongMemo + thuongMDRT;
      document.getElementById("tong-thu-nhap").value = formatNumber(tongThuNhap);

      // Tỷ lệ thu nhập trên FYP
      const tongFYP = getVal("tong-fyp");
      let tyLe = "";
      if (tongFYP > 0) {
        tyLe = ((tongThuNhap / tongFYP) * 100).toFixed(2) + " %";
      }
      document.getElementById("ty-le-thu-nhap").value = tyLe;
    }

    // ----------- XUẤT PDF 1 TRANG -----------
 function exportPDF() {
  // 1. Tạo div ảo trên cùng để render PDF
  let old = document.getElementById('pdf-export');
  if (old) old.remove(); // Xóa nếu đã tồn tại

  const main = document.querySelector('.container');
  const pdfDiv = document.createElement('div');
  pdfDiv.id = 'pdf-export';
  // Style tuyệt đối nằm sát trên, không bị ảnh hưởng bởi các margin/padding trang
  pdfDiv.style.position = 'fixed';
  pdfDiv.style.top = '0';
  pdfDiv.style.left = '0';
  pdfDiv.style.width = main.offsetWidth + 'px';
  pdfDiv.style.background = '#fff';
  pdfDiv.style.zIndex = '9999';
  pdfDiv.style.boxShadow = 'none';
  pdfDiv.style.margin = '0';
  pdfDiv.style.padding = '0';

  pdfDiv.innerHTML = main.innerHTML;
  document.body.appendChild(pdfDiv);

  // 2. Chờ 1 chút cho DOM render, rồi xuất PDF
  setTimeout(() => {
    const rect = pdfDiv.getBoundingClientRect();
    const dpi = 96;
    const pxToMm = px => px * 25.4 / dpi;
    const widthMM = pxToMm(rect.width);
    const heightMM = pxToMm(rect.height);

    const opt = {
      margin: 0,
      filename: 'du-tinh-thu-nhap.pdf',
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'mm', format: [widthMM, heightMM], orientation: 'portrait' }
    };

    html2pdf().set(opt)
      .from(pdfDiv)
      .toPdf()
      .save()
      .then(() => pdfDiv.remove());
  }, 500); // Cho render 1 tí trước khi chụp (có thể tăng lên 200 nếu máy chậm)
}


    window.onload = () => {
      loadData();
      populateMonthSelect();
      initEnterSearch();
      initEnterCC();
      document.getElementById("fyp-kem").addEventListener("keydown", function(e) {
        if (e.key === "Enter") {
          document.getElementById("calc-btn").click();
        }
      });
    };
  </script>
</head>
<body>
  <div class="container">
    <h1>CÔNG CỤ DỰ TÍNH THU NHẬP</h1>
    <div class="note-green">(Vui lòng nhập thông tin tại các ô tô màu)</div>
    <div class="note-right">Dữ liệu tham chiếu được chốt hết 31/07/2025</div>
    <hr>
    <div class="top-fields">
  <div class="field">
    <label for="month-select">Tháng dự tính</label>
    <select id="month-select"></select>
  </div>
  <div class="field">
    <label for="agent-id">Mã số đại lý</label>
    <input type="text" id="agent-id">
  </div>
  <div class="field">
    <label for="ngay-gia-nhap">Ngày gia nhập</label>
    <input type="text" id="ngay-gia-nhap">
  </div>
</div>
    <label>
      <button onclick="searchAgent()">Tìm kiếm</button>
    </label>
    <hr>
<div class="top-fields">
  
  <div class="field" style="flex: 6" >
    <label for="ho-ten">Họ và tên</label>
    <input type="text" id="ho-ten" readonly>
  </div>
</div>
<div class="top-fields">
    <div class="field" style="flex: 0.5">
    <label for="khu-vuc">Khu vực</label>
    <input type="text" id="khu-vuc" readonly>
  </div>
  <div class="field" style="flex: 1.5">
    <label for="thang-lam-viec">Thâm niên</label>
    <input type="text" id="thang-lam-viec" readonly>
</div>
  <div class="field" style="flex: 4">
    <label for="nhom-dai-ly">Phân nhóm đại lý</label>
    <input type="text" id="nhom-dai-ly" readonly>
    </div>
    
 
</div>
<div class="top-fields">
<div class="field" style="flex: 1">
    <label for="p13-ca-nhan">P13 cá nhân</label>
    <input type="text" id="p13-ca-nhan" readonly>
    </div>
    <div class="field" style="flex: 1">
    <label for="he-so-thuong">Hệ số tính thưởng</label>
       <input type="text" id="he-so-thuong" readonly>
        </div>
    </div>
<div class="top-fields">
    <div class="field" style="flex: 1">
    <label for="mdrt-fyp">∑ FYP DH MDRT</label>
      <input type="text" id="mdrt-fyp" readonly>
      </div>
    <div class="field" style="flex: 1">
    <label for="tong-fyc">∑ FYC T-1 và T-2</label>
    <input type="text" id="tong-fyc" readonly>
  </div>
  <div class="field" style="flex: 1">
    <label for="tong-fyc-quy">∑ FYC Quý hiện tại:</label>
    <input type="text" id="tong-fyc-quy" readonly>
  </div>
</div>

    
    <hr>
    <h2>MỤC TIÊU THÁNG HIỆN TẠI</h2>
    <label>
      Chọn giai đoạn nhận thưởng Memo KHỞI ĐỘNG NHANH, NHẬN QUÀ XANH <BR> 0001M08/2025/ASBD:
    </label>
    <div class="memo-group">
      <label><input type="radio" name="memo-period" value="1"> Giai đoạn 1 (1-11/8)</label>
      <label><input type="radio" name="memo-period" value="2"> Giai đoạn 2 (12-25/8)</label>
      <label><input type="radio" name="memo-period" value="3"> Giai đoạn 3 (26-31/8)</label>
    </div>
  
   <div class="top-fields">
  <div class="field" style="flex: 1">
    <label for="tong-cc">∑ Số lượng Hợp đồng</label>
    <input type="number" id="tong-cc">
  </div>
  <div class="field" style="flex: 1">
    <label for="fyp-chinh">∑ FYP SP chính </label>
    <input type="number" id="fyp-chinh">
  </div>
  <div class="field" style="flex: 1">
    <label for="fyp-kem">∑ FYP SP gắn kèm </label>
    <input type="number" id="fyp-kem">
  </div>
</div>
<div class="top-fields">
<div class="field" style="flex: 3">
    <label for="tong-fyp">∑ FYP Từ các HĐ</label>
    <input type="text" id="tong-fyp" readonly>
    </div>
    <div class="field" style="flex: 2">
    <button id="calc-btn" onclick="calculateIncome()">Tính thu nhập</button>
        </div>
    </div>

    <hr>
    <h2>CÁC KHOẢN THU NHẬP</h2>
     <div class="income-mini-title">1. Hoa hồng sản phẩm (FYC)</div>
   <div class="top-fields">
  <div class="field" style="flex: 1">
    <label>FYC SP chính (30%)</label>
    <input type="text" id="fyc-chinh" readonly>
  </div>
  <div class="field" style="flex: 1">
    <label>FYC SP gắn kèm (20%)</label>
    <input type="text" id="fyc-kem" readonly>
  </div>
</div>
<div class="top-fields">
  <div class="field" style="flex: 1">
    <label>Thưởng thêm SP gắn kèm (20%)</label>
    <input type="text" id="thuong-kem" readonly>
  </div>
  <div class="field" style="flex: 1">
    <label>FYC Tính chính sách</label>
    <input type="text" id="fyc-thuong" readonly>
  </div>
</div>
 <div class="income-mini-title">2. Thưởng theo Chính sách chi trả </div>
<div class="top-fields">
  <div class="field" style="flex: 1">
    <label>Thưởng NSXS Manulife Pro</label>
    <input type="text" id="thuong-nspro" readonly>
  </div>
  <div class="field" style="flex: 1">
    <label>Thưởng Năng suất hàng tháng</label>
    <input type="text" id="thuong-nst" readonly>
  </div>
</div>
<div class="top-fields">
  <div class="field" style="flex: 1">
    <label>Thưởng Năng suất hàng Quý</label>
    <input type="text" id="thuong-nsq" readonly>
  </div>
  <div class="field" style="flex: 1">
    <label>Thưởng Tiến độ MDRT</label>
    <input type="text" id="thuong-mdrt" readonly>
  </div>
</div>
 <div class="income-mini-title">3. Thưởng theo Memo hàng Tháng</div>
   <div class="top-fields"></div>
  <div class="field" style="flex: 1">
    <label for="thuong-memo" class="income-note">0001M08/2025/ASBD</label>
        <input type="text" id="thuong-memo" maxlength="12" readonly>
  </div>

    <hr>
    <h2>THU NHẬP</h2>
     <div class="summary-row">
      <div class="summary-block">
        <label for="tong-thu-nhap">Tổng thu nhập dự kiến</label>
        <input type="text" id="tong-thu-nhap" readonly>
      </div>
      <div class="summary-block">
        <label for="ty-le-thu-nhap">Tỷ lệ thu nhập/doanh thu</label>
        <input type="text" id="ty-le-thu-nhap" readonly>
      </div>
    </div>
    
    <div style="text-align: center; margin-top: 1em;">
    <button onclick="exportPDF()">Xuất PDF</button>
    </div>
  </div>
</body>
</html>
